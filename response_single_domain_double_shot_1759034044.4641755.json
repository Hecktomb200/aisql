{
  "strategy": "single_domain_double_shot",
  "prompt_prefix": "PRAGMA foreign_keys = ON;\n\nDROP TABLE IF EXISTS Pizza_Topping;\nDROP TABLE IF EXISTS Pizza;\nDROP TABLE IF EXISTS Topping;\nDROP TABLE IF EXISTS Sauce;\nDROP TABLE IF EXISTS Crust;\nDROP TABLE IF EXISTS \"Order\";\nDROP TABLE IF EXISTS Address;\nDROP TABLE IF EXISTS Customer;\nDROP TABLE IF EXISTS Employee;\nDROP TABLE IF EXISTS Store;\n\nCREATE TABLE Address (\n    address_id INTEGER PRIMARY KEY AUTOINCREMENT,\n    street TEXT NOT NULL,\n    city TEXT NOT NULL,\n    state TEXT NOT NULL,\n    zip TEXT NOT NULL\n);\n\nCREATE TABLE Store (\n    store_id INTEGER PRIMARY KEY AUTOINCREMENT,\n    name TEXT NOT NULL,\n    address_id INTEGER,\n    phone TEXT,\n    FOREIGN KEY (address_id) REFERENCES Address(address_id)\n);\n\nCREATE TABLE Customer (\n    customer_id INTEGER PRIMARY KEY AUTOINCREMENT,\n    first_name TEXT NOT NULL,\n    last_name TEXT NOT NULL,\n    phone_number TEXT,\n    email TEXT\n);\n\nCREATE TABLE \"Order\" (\n    order_id INTEGER PRIMARY KEY AUTOINCREMENT,\n    customer_id INTEGER NOT NULL,\n    address_id INTEGER,\n    store_id INTEGER NOT NULL,\n    order_date TEXT NOT NULL, \n    total_amount REAL NOT NULL,\n    delivery INTEGER NOT NULL DEFAULT 0,\n    FOREIGN KEY (customer_id) REFERENCES Customer(customer_id),\n    FOREIGN KEY (address_id) REFERENCES Address(address_id),\n    FOREIGN KEY (store_id) REFERENCES Store(store_id)\n);\n\nCREATE TABLE Crust (\n    crust_id INTEGER PRIMARY KEY AUTOINCREMENT,\n    name TEXT NOT NULL,\n    extra_cost REAL DEFAULT 0.0\n);\n\nCREATE TABLE Sauce (\n    sauce_id INTEGER PRIMARY KEY AUTOINCREMENT,\n    name TEXT NOT NULL,\n    extra_cost REAL DEFAULT 0.0\n);\n\nCREATE TABLE Topping (\n    topping_id INTEGER PRIMARY KEY AUTOINCREMENT,\n    name TEXT NOT NULL,\n    extra_cost REAL DEFAULT 0.0\n);\n\nCREATE TABLE Pizza (\n    pizza_id INTEGER PRIMARY KEY AUTOINCREMENT,\n    order_id INTEGER NOT NULL,\n    size TEXT NOT NULL,\n    crust_id INTEGER NOT NULL,\n    sauce_id INTEGER NOT NULL,\n    FOREIGN KEY (order_id) REFERENCES \"Order\"(order_id),\n    FOREIGN KEY (crust_id) REFERENCES Crust(crust_id),\n    FOREIGN KEY (sauce_id) REFERENCES Sauce(sauce_id)\n);\n\nCREATE TABLE Pizza_Topping (\n    pizza_id INTEGER NOT NULL,\n    topping_id INTEGER NOT NULL,\n    PRIMARY KEY (pizza_id, topping_id),\n    FOREIGN KEY (pizza_id) REFERENCES Pizza(pizza_id),\n    FOREIGN KEY (topping_id) REFERENCES Topping(topping_id)\n);\n\nCREATE TABLE Employee (\n    employee_id INTEGER PRIMARY KEY AUTOINCREMENT,\n    first_name TEXT NOT NULL,\n    last_name TEXT NOT NULL,\n    store_id INTEGER NOT NULL,\n    role TEXT,\n    hourly_rate REAL NOT NULL,\n    date_hired TEXT NOT NULL,\n    phone_number TEXT,\n    FOREIGN KEY (store_id) REFERENCES Store(store_id)\n);\n Example: List all crust names.\n SELECT name FROM Crust ORDER BY name;\n  Give me a sqlite SELECT statement that answers the question. Only respond with sqlite syntax. If there is an error do not explain it!",
  "questionResults": [
    {
      "question": "Which store has the highest total sales?",
      "sql": "SELECT s.name\nFROM Store s\nJOIN \"Order\" o ON s.store_id = o.store_id\nGROUP BY s.store_id\nORDER BY SUM(o.total_amount) DESC\nLIMIT 1;",
      "queryRawResponse": "[('ChatPizza Lehi',)]",
      "friendlyResponse": "ChatPizza Lehi.",
      "error": "None"
    },
    {
      "question": "List each customer and how many orders they have placed.",
      "sql": "SELECT Customer.first_name, Customer.last_name, COUNT(\"Order\".order_id) AS order_count\nFROM Customer\nLEFT JOIN \"Order\" ON Customer.customer_id = \"Order\".customer_id\nGROUP BY Customer.customer_id;",
      "queryRawResponse": "[('Laura', 'Stevenson', 1), ('Bob', 'Jones', 1), ('Charlie', 'Brown', 0), ('Sydney', 'Smith', 1)]",
      "friendlyResponse": "Laura Stevenson: 1 order  \nBob Jones: 1 order  \nCharlie Brown: 0 orders  \nSydney Smith: 1 order",
      "error": "None"
    },
    {
      "question": "Which orders were deliveries and to which cities?",
      "sql": "SELECT \"Order\".order_id, Address.city \nFROM \"Order\"\nJOIN Address ON \"Order\".address_id = Address.address_id\nWHERE \"Order\".delivery = 1;",
      "queryRawResponse": "[(2, 'Orem')]",
      "friendlyResponse": "Order 2 was delivered to Orem.",
      "error": "None"
    },
    {
      "question": "Show each pizza with its size and a comma-separated list of toppings.",
      "sql": "SELECT \n    Pizza.pizza_id,\n    Pizza.size,\n    GROUP_CONCAT(Topping.name, ', ') AS toppings\nFROM \n    Pizza\nLEFT JOIN \n    Pizza_Topping ON Pizza.pizza_id = Pizza_Topping.pizza_id\nLEFT JOIN \n    Topping ON Pizza_Topping.topping_id = Topping.topping_id\nGROUP BY \n    Pizza.pizza_id, Pizza.size;",
      "queryRawResponse": "[(1, 'Medium', 'Mozzarella, Pepperoni, Mushrooms'), (2, 'Large', 'Mozzarella, Sausage, Onions, Olives'), (3, 'Small', 'Mozzarella, Mushrooms, Olives'), (4, 'Large', 'Mozzarella, Pepperoni, Sausage, Mushrooms, Onions, Olives, Basil')]",
      "friendlyResponse": "1. Medium: Mozzarella, Pepperoni, Mushrooms  \n2. Large: Mozzarella, Sausage, Onions, Olives  \n3. Small: Mozzarella, Mushrooms, Olives  \n4. Large: Mozzarella, Pepperoni, Sausage, Mushrooms, Onions, Olives, Basil",
      "error": "None"
    },
    {
      "question": "What are the top 3 most popular toppings by usage count?",
      "sql": "SELECT Topping.name, COUNT(*) AS usage_count\nFROM Topping\nJOIN Pizza_Topping ON Topping.topping_id = Pizza_Topping.topping_id\nGROUP BY Topping.topping_id\nORDER BY usage_count DESC\nLIMIT 3;",
      "queryRawResponse": "[('Mozzarella', 4), ('Olives', 3), ('Mushrooms', 3)]",
      "friendlyResponse": "The top 3 most popular toppings are Mozzarella with 4 counts, and Olives and Mushrooms, each with 3 counts.",
      "error": "None"
    },
    {
      "question": "For each store, how many pizzas were sold?",
      "sql": "SELECT s.store_id, COUNT(p.pizza_id) AS pizzas_sold\nFROM Store s\nJOIN \"Order\" o ON s.store_id = o.store_id\nJOIN Pizza p ON o.order_id = p.order_id\nGROUP BY s.store_id;",
      "queryRawResponse": "[(1, 1), (2, 2), (3, 1)]",
      "friendlyResponse": "Store 1 sold 1 pizza, store 2 sold 2 pizzas, and store 3 sold 1 pizza.",
      "error": "None"
    }
  ]
}